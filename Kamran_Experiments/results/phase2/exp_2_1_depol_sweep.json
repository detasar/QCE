{
  "experiment": "exp_2_1_depol_sweep",
  "timestamp": "2025-12-07T03:13:21.715399",
  "tests": {
    "depolarizing_sweep": {
      "type": "depolarizing_sweep",
      "n_pairs": 10000,
      "results": [
        {
          "noise_level": 0.0,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4441,
            "sifting_rate": 0.49377362686235265,
            "chsh_value": 2.763309396392,
            "chsh_std": 0.09113210841742594,
            "chsh_violation": true,
            "qber": 0.0,
            "qber_ci": 0.004288860203798327,
            "key_rate_theoretical": 1.0
          },
          "S_theory": 2.8284271247461903,
          "S_measured": 2.763309396392,
          "S_error": 0.02302259364735569
        },
        {
          "noise_level": 0.005,
          "result": {
            "p_single": 0.005,
            "p_two": 0.01,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4414,
            "sifting_rate": 0.49066251667407734,
            "chsh_value": 2.70114586369222,
            "chsh_std": 0.09307743840914436,
            "chsh_violation": true,
            "qber": 0.0045351473922902496,
            "qber_ci": 0.0075691846916778075,
            "key_rate_theoretical": 0.9163351155335859
          },
          "S_theory": 2.758350371392403,
          "S_measured": 2.70114586369222,
          "S_error": 0.02073866623089897
        },
        {
          "noise_level": 0.01,
          "result": {
            "p_single": 0.01,
            "p_two": 0.02,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4538,
            "sifting_rate": 0.5029369389338357,
            "chsh_value": 2.6825522223223945,
            "chsh_std": 0.0949486939698166,
            "chsh_violation": true,
            "qber": 0.019867549668874173,
            "qber_ci": 0.01341796241314254,
            "key_rate_theoretical": 0.7186075493663725
          },
          "S_theory": 2.6895316104998215,
          "S_measured": 2.6825522223223945,
          "S_error": 0.0025950199470345285
        },
        {
          "noise_level": 0.02,
          "result": {
            "p_single": 0.02,
            "p_two": 0.04,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4574,
            "sifting_rate": 0.5093541202672606,
            "chsh_value": 2.4023875041056897,
            "chsh_std": 0.10001772150675861,
            "chsh_violation": true,
            "qber": 0.0437636761487965,
            "qber_ci": 0.019060463271695326,
            "key_rate_theoretical": 0.4814199028795224
          },
          "S_theory": 2.555609263098351,
          "S_measured": 2.4023875041056897,
          "S_error": 0.059955080459717675
        },
        {
          "noise_level": 0.03,
          "result": {
            "p_single": 0.03,
            "p_two": 0.06,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4496,
            "sifting_rate": 0.5005009462317711,
            "chsh_value": 2.4527226602835555,
            "chsh_std": 0.09926765549290396,
            "chsh_violation": true,
            "qber": 0.07349665924276169,
            "qber_ci": 0.024305141589405006,
            "key_rate_theoretical": 0.24232189170043783
          },
          "S_theory": 2.4265433250700705,
          "S_measured": 2.4527226602835555,
          "S_error": 0.010788735953325272
        },
        {
          "noise_level": 0.05,
          "result": {
            "p_single": 0.05,
            "p_two": 0.1,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4440,
            "sifting_rate": 0.49338815423935994,
            "chsh_value": 2.3727796328312927,
            "chsh_std": 0.10169252438298358,
            "chsh_violation": true,
            "qber": 0.09684684684684684,
            "qber_ci": 0.027608526920726024,
            "key_rate_theoretical": 0.08216021982507293
          },
          "S_theory": 2.182520435471338,
          "S_measured": 2.3727796328312927,
          "S_error": 0.08717407373043283
        },
        {
          "noise_level": 0.07,
          "result": {
            "p_single": 0.07,
            "p_two": 0.14,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4611,
            "sifting_rate": 0.5134743875278397,
            "chsh_value": 2.001548991221769,
            "chsh_std": 0.10835492083962985,
            "chsh_violation": true,
            "qber": 0.14967462039045554,
            "qber_ci": 0.03256011231398356,
            "key_rate_theoretical": 0.0
          },
          "S_theory": 1.956556034830345,
          "S_measured": 2.001548991221769,
          "S_error": 0.02299599683856005
        },
        {
          "noise_level": 0.1,
          "result": {
            "p_single": 0.1,
            "p_two": 0.2,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4502,
            "sifting_rate": 0.5006115867897254,
            "chsh_value": 1.7085020305395098,
            "chsh_std": 0.11396020873614325,
            "chsh_violation": false,
            "qber": 0.14888888888888888,
            "qber_ci": 0.03288524187580115,
            "key_rate_theoretical": 0.0
          },
          "S_theory": 1.6495386991519783,
          "S_measured": 1.7085020305395098,
          "S_error": 0.03574534590661277
        },
        {
          "noise_level": 0.15,
          "result": {
            "p_single": 0.15,
            "p_two": 0.3,
            "p_readout": 0.0,
            "n_pairs": 10000,
            "n_sifted": 4462,
            "sifting_rate": 0.49374792519641475,
            "chsh_value": 1.4767952959707176,
            "chsh_std": 0.11975093065998445,
            "chsh_violation": false,
            "qber": 0.23766816143497757,
            "qber_ci": 0.03939844462675442,
            "key_rate_theoretical": 0.0
          },
          "S_theory": 1.2159054655893275,
          "S_measured": 1.4767952959707176,
          "S_error": 0.21456423855693535
        }
      ]
    },
    "readout_error": {
      "type": "readout_error_test",
      "n_pairs": 8000,
      "results": [
        {
          "p_readout": 0.0,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.0,
            "n_pairs": 8000,
            "n_sifted": 3611,
            "sifting_rate": 0.5008321775312067,
            "chsh_value": 2.8083080575449273,
            "chsh_std": 0.10116585926297593,
            "chsh_violation": true,
            "qber": 0.0,
            "qber_ci": 0.005264559067808763,
            "key_rate_theoretical": 1.0
          }
        },
        {
          "p_readout": 0.01,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.01,
            "n_pairs": 8000,
            "n_sifted": 3526,
            "sifting_rate": 0.49033514114865806,
            "chsh_value": 2.674683631890211,
            "chsh_std": 0.10449722720461481,
            "chsh_violation": true,
            "qber": 0.019886363636363636,
            "qber_ci": 0.01540377387691588,
            "key_rate_theoretical": 0.718395937606153
          }
        },
        {
          "p_readout": 0.02,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.02,
            "n_pairs": 8000,
            "n_sifted": 3573,
            "sifting_rate": 0.499510694813365,
            "chsh_value": 2.5404327745812076,
            "chsh_std": 0.10588521934673215,
            "chsh_violation": true,
            "qber": 0.047619047619047616,
            "qber_ci": 0.022494397749750768,
            "key_rate_theoretical": 0.44760914470412183
          }
        },
        {
          "p_readout": 0.05,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.05,
            "n_pairs": 8000,
            "n_sifted": 3616,
            "sifting_rate": 0.498827424472341,
            "chsh_value": 2.3316698416105464,
            "chsh_std": 0.11833032976678666,
            "chsh_violation": true,
            "qber": 0.09695290858725762,
            "qber_ci": 0.030657227067817212,
            "key_rate_theoretical": 0.08147711449383044
          }
        },
        {
          "p_readout": 0.1,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.1,
            "n_pairs": 8000,
            "n_sifted": 3609,
            "sifting_rate": 0.5013196277260731,
            "chsh_value": 1.6773148148148147,
            "chsh_std": 0.12828027098927625,
            "chsh_violation": false,
            "qber": 0.16944444444444445,
            "qber_ci": 0.03870461924429248,
            "key_rate_theoretical": 0.0
          }
        },
        {
          "p_readout": 0.15,
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.15,
            "n_pairs": 8000,
            "n_sifted": 3625,
            "sifting_rate": 0.5029134295227525,
            "chsh_value": 1.3580194835259711,
            "chsh_std": 0.1338137153467282,
            "chsh_violation": false,
            "qber": 0.2513812154696133,
            "qber_ci": 0.04452931634039524,
            "key_rate_theoretical": 0.0
          }
        }
      ]
    },
    "combined_noise": {
      "type": "combined_noise_test",
      "n_pairs": 8000,
      "results": [
        {
          "name": "Ideal",
          "config": {
            "name": "Ideal",
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.0
          },
          "result": {
            "p_single": 0.0,
            "p_two": 0.0,
            "p_readout": 0.0,
            "n_pairs": 8000,
            "n_sifted": 3643,
            "sifting_rate": 0.505480782572499,
            "chsh_value": 2.757776636067712,
            "chsh_std": 0.10297547769460805,
            "chsh_violation": true,
            "qber": 0.0,
            "qber_ci": 0.005221622969050181,
            "key_rate_theoretical": 1.0
          },
          "secure": true
        },
        {
          "name": "Excellent",
          "config": {
            "name": "Excellent",
            "p_single": 0.001,
            "p_two": 0.005,
            "p_readout": 0.01
          },
          "result": {
            "p_single": 0.001,
            "p_two": 0.005,
            "p_readout": 0.01,
            "n_pairs": 8000,
            "n_sifted": 3520,
            "sifting_rate": 0.49237655616170095,
            "chsh_value": 2.683719813694632,
            "chsh_std": 0.10133631321852304,
            "chsh_violation": true,
            "qber": 0.008522727272727272,
            "qber_ci": 0.01092578586480897,
            "key_rate_theoretical": 0.8583352482329741
          },
          "secure": true
        },
        {
          "name": "Good (IonQ-like)",
          "config": {
            "name": "Good (IonQ-like)",
            "p_single": 0.002,
            "p_two": 0.01,
            "p_readout": 0.01
          },
          "result": {
            "p_single": 0.002,
            "p_two": 0.01,
            "p_readout": 0.01,
            "n_pairs": 8000,
            "n_sifted": 3596,
            "sifting_rate": 0.49778516057585825,
            "chsh_value": 2.6724913700436757,
            "chsh_std": 0.10658697415117069,
            "chsh_violation": true,
            "qber": 0.025069637883008356,
            "qber_ci": 0.016853624732406997,
            "key_rate_theoretical": 0.6619422953304762
          },
          "secure": true
        },
        {
          "name": "Moderate (IBM-like)",
          "config": {
            "name": "Moderate (IBM-like)",
            "p_single": 0.005,
            "p_two": 0.02,
            "p_readout": 0.03
          },
          "result": {
            "p_single": 0.005,
            "p_two": 0.02,
            "p_readout": 0.03,
            "n_pairs": 8000,
            "n_sifted": 3522,
            "sifting_rate": 0.48828504089837793,
            "chsh_value": 2.5496693750719848,
            "chsh_std": 0.10991840068798636,
            "chsh_violation": true,
            "qber": 0.06818181818181818,
            "qber_ci": 0.026600700370152646,
            "key_rate_theoretical": 0.28179674870290117
          },
          "secure": true
        },
        {
          "name": "Noisy",
          "config": {
            "name": "Noisy",
            "p_single": 0.01,
            "p_two": 0.04,
            "p_readout": 0.05
          },
          "result": {
            "p_single": 0.01,
            "p_two": 0.04,
            "p_readout": 0.05,
            "n_pairs": 8000,
            "n_sifted": 3594,
            "sifting_rate": 0.5016050244242847,
            "chsh_value": 2.163584190772376,
            "chsh_std": 0.11630544173222301,
            "chsh_violation": true,
            "qber": 0.11142061281337047,
            "qber_ci": 0.032636131872095395,
            "key_rate_theoretical": 0.0
          },
          "secure": false
        },
        {
          "name": "Very Noisy",
          "config": {
            "name": "Very Noisy",
            "p_single": 0.02,
            "p_two": 0.08,
            "p_readout": 0.1
          },
          "result": {
            "p_single": 0.02,
            "p_two": 0.08,
            "p_readout": 0.1,
            "n_pairs": 8000,
            "n_sifted": 3591,
            "sifting_rate": 0.4971618441090959,
            "chsh_value": 1.541819150739741,
            "chsh_std": 0.1322940093599972,
            "chsh_violation": false,
            "qber": 0.21727019498607242,
            "qber_ci": 0.042537657605491414,
            "key_rate_theoretical": 0.0
          },
          "secure": false
        }
      ]
    },
    "threshold_search": {
      "type": "threshold_search",
      "n_pairs": 5000,
      "results": [
        {
          "p_single": 0.0,
          "chsh": 2.5883297600565154,
          "qber": 0.0,
          "violation": true
        },
        {
          "p_single": 0.01,
          "chsh": 2.601353515021149,
          "qber": 0.02654867256637168,
          "violation": true
        },
        {
          "p_single": 0.02,
          "chsh": 2.690458429353118,
          "qber": 0.03587443946188341,
          "violation": true
        },
        {
          "p_single": 0.03,
          "chsh": 2.408121212121212,
          "qber": 0.0684931506849315,
          "violation": true
        },
        {
          "p_single": 0.04,
          "chsh": 2.490620308070631,
          "qber": 0.07657657657657657,
          "violation": true
        },
        {
          "p_single": 0.05,
          "chsh": 2.137920554770119,
          "qber": 0.09009009009009009,
          "violation": true
        },
        {
          "p_single": 0.06,
          "chsh": 2.159583877047992,
          "qber": 0.14479638009049775,
          "violation": true
        },
        {
          "p_single": 0.07,
          "chsh": 1.9615438336368571,
          "qber": 0.13063063063063063,
          "violation": false
        },
        {
          "p_single": 0.08,
          "chsh": 2.3322780221960926,
          "qber": 0.11946902654867257,
          "violation": true
        },
        {
          "p_single": 0.09,
          "chsh": 1.627713505420001,
          "qber": 0.15859030837004406,
          "violation": false
        },
        {
          "p_single": 0.1,
          "chsh": 2.050974100291578,
          "qber": 0.16371681415929204,
          "violation": true
        },
        {
          "p_single": 0.11,
          "chsh": 1.6031852149869477,
          "qber": 0.18502202643171806,
          "violation": false
        },
        {
          "p_single": 0.12,
          "chsh": 1.8338643679552769,
          "qber": 0.23478260869565218,
          "violation": false
        },
        {
          "p_single": 0.13,
          "chsh": 1.5008447956448392,
          "qber": 0.20089285714285715,
          "violation": false
        },
        {
          "p_single": 0.14,
          "chsh": 1.6969024832409723,
          "qber": 0.23478260869565218,
          "violation": false
        },
        {
          "p_single": 0.15,
          "chsh": 1.5609237879390476,
          "qber": 0.23376623376623376,
          "violation": false
        }
      ],
      "chsh_threshold": 0.07,
      "qber_threshold": 0.06
    }
  },
  "validation": {
    "checks": [
      {
        "name": "CHSH decreases with noise",
        "passed": true,
        "detail": "Values: ['2.76', '2.70', '2.68', '2.40', '2.45', '2.37', '2.00', '1.71', '1.48']"
      },
      {
        "name": "Theory-experiment agreement",
        "passed": "False",
        "detail": "Mean error: 5.3%, Max: 21.5%"
      },
      {
        "name": "CHSH threshold in expected range",
        "passed": "True",
        "detail": "Found: p=0.0700"
      },
      {
        "name": "Ideal case near Tsirelson bound",
        "passed": "True",
        "detail": "S=2.763 vs 2.828"
      }
    ],
    "all_passed": false
  },
  "summary": {
    "overall_passed": false,
    "chsh_threshold": 0.07,
    "qber_threshold": 0.06,
    "secure_configs": 4
  }
}