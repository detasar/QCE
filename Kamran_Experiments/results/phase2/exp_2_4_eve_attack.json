{
  "experiment": "exp_2_4_eve_attack",
  "timestamp": "2025-12-07T03:31:37.487151",
  "tests": {
    "intercept_resend_sweep": {
      "type": "intercept_resend_sweep",
      "results": [
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.0,
          "n_pairs": 12000,
          "n_sifted": 5523,
          "sifting_rate": 0.5096428900987359,
          "chsh_value": 2.90936009459584,
          "chsh_std": 0.08059935623542885,
          "chsh_violation": true,
          "qber": 0.0,
          "qber_ci": 0.0034555346310838255,
          "eve_info_bits": 0.0,
          "detected": false,
          "detection_method": "Not detected",
          "qber_theory": 0.0,
          "chsh_theory": 2.8284271247461903,
          "eve_info_theory": 0.0
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.1,
          "n_pairs": 12000,
          "n_sifted": 5394,
          "sifting_rate": 0.5,
          "chsh_value": 2.5380212771840265,
          "chsh_std": 0.08855803957681094,
          "chsh_violation": true,
          "qber": 0.03153988868274583,
          "qber_ci": 0.015071321655765156,
          "eve_info_bits": 0.05,
          "detected": false,
          "detection_method": "Not detected",
          "qber_theory": 0.025,
          "chsh_theory": 2.6870057685088806,
          "eve_info_theory": 0.05
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.2,
          "n_pairs": 12000,
          "n_sifted": 5362,
          "sifting_rate": 0.4940569427807979,
          "chsh_value": 2.226031014621179,
          "chsh_std": 0.09844240303545218,
          "chsh_violation": true,
          "qber": 0.03917910447761194,
          "qber_ci": 0.016692052046450623,
          "eve_info_bits": 0.1,
          "detected": false,
          "detection_method": "Not detected",
          "qber_theory": 0.05,
          "chsh_theory": 2.5455844122715714,
          "eve_info_theory": 0.1
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.3,
          "n_pairs": 12000,
          "n_sifted": 5368,
          "sifting_rate": 0.4975437946056168,
          "chsh_value": 1.9521433248420812,
          "chsh_std": 0.10029398002809674,
          "chsh_violation": false,
          "qber": 0.07276119402985075,
          "qber_ci": 0.0221208344973296,
          "eve_info_bits": 0.15,
          "detected": true,
          "detection_method": "CHSH violation lost",
          "qber_theory": 0.075,
          "chsh_theory": 2.4041630560342617,
          "eve_info_theory": 0.15
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.4,
          "n_pairs": 12000,
          "n_sifted": 5422,
          "sifting_rate": 0.500646352723915,
          "chsh_value": 1.5457630290457038,
          "chsh_std": 0.10778611179098946,
          "chsh_violation": false,
          "qber": 0.11808118081180811,
          "qber_ci": 0.027205048652224745,
          "eve_info_bits": 0.2,
          "detected": true,
          "detection_method": "CHSH violation lost",
          "qber_theory": 0.1,
          "chsh_theory": 2.2627416997969525,
          "eve_info_theory": 0.2
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.5,
          "n_pairs": 12000,
          "n_sifted": 5370,
          "sifting_rate": 0.5000931272117712,
          "chsh_value": 1.3864733477736575,
          "chsh_std": 0.10539789041157713,
          "chsh_violation": false,
          "qber": 0.1303538175046555,
          "qber_ci": 0.028496885420943443,
          "eve_info_bits": 0.25,
          "detected": true,
          "detection_method": "CHSH violation lost",
          "qber_theory": 0.125,
          "chsh_theory": 2.121320343559643,
          "eve_info_theory": 0.25
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.6,
          "n_pairs": 12000,
          "n_sifted": 5445,
          "sifting_rate": 0.5048210643426664,
          "chsh_value": 0.9491175534260554,
          "chsh_std": 0.11137171232292195,
          "chsh_violation": false,
          "qber": 0.1636029411764706,
          "qber_ci": 0.031065476060758542,
          "eve_info_bits": 0.3,
          "detected": true,
          "detection_method": "CHSH violation lost",
          "qber_theory": 0.15,
          "chsh_theory": 1.9798989873223332,
          "eve_info_theory": 0.3
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 0.8,
          "n_pairs": 12000,
          "n_sifted": 5374,
          "sifting_rate": 0.49819226847130804,
          "chsh_value": 0.5824816695092011,
          "chsh_std": 0.11367807340030112,
          "chsh_violation": false,
          "qber": 0.1973929236499069,
          "qber_ci": 0.033613986785018445,
          "eve_info_bits": 0.4,
          "detected": true,
          "detection_method": "CHSH violation lost",
          "qber_theory": 0.2,
          "chsh_theory": 1.697056274847714,
          "eve_info_theory": 0.4
        },
        {
          "attack_type": "intercept_resend",
          "attack_strength": 1.0,
          "n_pairs": 12000,
          "n_sifted": 5489,
          "sifting_rate": 0.506412030630132,
          "chsh_value": 0.010358339502373972,
          "chsh_std": 0.11745165019253109,
          "chsh_violation": false,
          "qber": 0.2664233576642336,
          "qber_ci": 0.03692082363054194,
          "eve_info_bits": 0.5,
          "detected": true,
          "detection_method": "CHSH violation lost",
          "qber_theory": 0.25,
          "chsh_theory": 1.4142135623730951,
          "eve_info_theory": 0.5
        }
      ]
    },
    "decorrelation_sweep": {
      "type": "decorrelation_sweep",
      "results": [
        {
          "strength": 0.0,
          "qber": 0.0,
          "qber_theory": 0.0,
          "chsh_value": 2.8983211270734612,
          "chsh_theory": 2.8284271247461903,
          "chsh_violation": true,
          "detected": false,
          "detection_method": "Not detected"
        },
        {
          "strength": 0.1,
          "qber": 0.03717472118959108,
          "qber_theory": 0.05,
          "chsh_value": 2.6695522299704413,
          "chsh_theory": 2.5455844122715714,
          "chsh_violation": true,
          "detected": false,
          "detection_method": "Not detected"
        },
        {
          "strength": 0.2,
          "qber": 0.0825515947467167,
          "qber_theory": 0.1,
          "chsh_value": 1.9995424334205254,
          "chsh_theory": 2.2627416997969525,
          "chsh_violation": false,
          "detected": true,
          "detection_method": "CHSH violation lost"
        },
        {
          "strength": 0.3,
          "qber": 0.1425925925925926,
          "qber_theory": 0.15,
          "chsh_value": 2.018503074417965,
          "chsh_theory": 1.9798989873223332,
          "chsh_violation": true,
          "detected": true,
          "detection_method": "QBER threshold exceeded"
        },
        {
          "strength": 0.4,
          "qber": 0.19444444444444445,
          "qber_theory": 0.2,
          "chsh_value": 1.4881585126043293,
          "chsh_theory": 1.697056274847714,
          "chsh_violation": false,
          "detected": true,
          "detection_method": "CHSH violation lost"
        },
        {
          "strength": 0.5,
          "qber": 0.25139664804469275,
          "qber_theory": 0.25,
          "chsh_value": 1.3405333418633911,
          "chsh_theory": 1.4142135623730951,
          "chsh_violation": false,
          "detected": true,
          "detection_method": "CHSH violation lost"
        }
      ]
    },
    "cloning_attack": {
      "type": "cloning_attack",
      "results": [
        {
          "fidelity": 1.0,
          "qber": 0.0,
          "qber_theory": 0.0,
          "chsh_value": 2.870950813280937,
          "chsh_violation": true,
          "eve_info": 0.0,
          "detected": false,
          "detection_method": "Not detected"
        },
        {
          "fidelity": 0.8333333333333334,
          "qber": 0.14684014869888476,
          "qber_theory": 0.16666666666666663,
          "chsh_value": 2.025064977265266,
          "chsh_violation": true,
          "eve_info": 0.6500224216483541,
          "detected": true,
          "detection_method": "QBER threshold exceeded"
        },
        {
          "fidelity": 0.75,
          "qber": 0.23302752293577983,
          "qber_theory": 0.25,
          "chsh_value": 1.3633023669996311,
          "chsh_violation": false,
          "eve_info": 0.8112781244591328,
          "detected": true,
          "detection_method": "CHSH violation lost"
        },
        {
          "fidelity": 0.6,
          "qber": 0.3771106941838649,
          "qber_theory": 0.4,
          "chsh_value": 0.788033851411688,
          "chsh_violation": false,
          "eve_info": 0.9709505944546686,
          "detected": true,
          "detection_method": "CHSH violation lost"
        },
        {
          "fidelity": 0.5,
          "qber": 0.5037037037037037,
          "qber_theory": 0.5,
          "chsh_value": -0.002615088845393493,
          "chsh_violation": false,
          "eve_info": 1.0,
          "detected": true,
          "detection_method": "CHSH violation lost"
        }
      ]
    },
    "detection_threshold": {
      "type": "detection_threshold",
      "results": [
        {
          "p_intercept": 0.0,
          "qber": 0.0,
          "qber_std": 0.0,
          "chsh_value": 2.8759929465425906,
          "chsh_std": 0.10637780714641691,
          "eve_info": 0.0,
          "detected": false,
          "detection_rate": 0.0,
          "method": "0/3 runs detected"
        },
        {
          "p_intercept": 0.049999999999999996,
          "qber": 0.020398998430531005,
          "qber_std": 0.011495653429251183,
          "chsh_value": 2.6549725109099667,
          "chsh_std": 0.10873043020107939,
          "eve_info": 0.024999999999999998,
          "detected": false,
          "detection_rate": 0.0,
          "method": "0/3 runs detected"
        },
        {
          "p_intercept": 0.09999999999999999,
          "qber": 0.04032393060330677,
          "qber_std": 0.007067645625692356,
          "chsh_value": 2.4636108640576992,
          "chsh_std": 0.1009877432631982,
          "eve_info": 0.049999999999999996,
          "detected": false,
          "detection_rate": 0.0,
          "method": "0/3 runs detected"
        },
        {
          "p_intercept": 0.15,
          "qber": 0.023662940971515178,
          "qber_std": 0.007977085734773529,
          "chsh_value": 2.5050967641254904,
          "chsh_std": 0.18601501332426787,
          "eve_info": 0.075,
          "detected": false,
          "detection_rate": 0.0,
          "method": "0/3 runs detected"
        },
        {
          "p_intercept": 0.19999999999999998,
          "qber": 0.038669884687583804,
          "qber_std": 0.003963815761201798,
          "chsh_value": 2.1456101499053704,
          "chsh_std": 0.2279392631026772,
          "eve_info": 0.09999999999999999,
          "detected": false,
          "detection_rate": 0.3333333333333333,
          "method": "1/3 runs detected"
        },
        {
          "p_intercept": 0.24999999999999997,
          "qber": 0.0660851724861295,
          "qber_std": 0.013804158141360176,
          "chsh_value": 2.055562622038136,
          "chsh_std": 0.041904742221999254,
          "eve_info": 0.12499999999999999,
          "detected": false,
          "detection_rate": 0.3333333333333333,
          "method": "1/3 runs detected"
        },
        {
          "p_intercept": 0.3,
          "qber": 0.08251008255817521,
          "qber_std": 0.016640930457379955,
          "chsh_value": 1.9903730412746896,
          "chsh_std": 0.04642544839264466,
          "eve_info": 0.15,
          "detected": true,
          "detection_rate": 0.6666666666666666,
          "method": "2/3 runs detected"
        },
        {
          "p_intercept": 0.35,
          "qber": 0.08415395030816458,
          "qber_std": 0.03771278426705613,
          "chsh_value": 2.0527693996998218,
          "chsh_std": 0.1439176709649725,
          "eve_info": 0.175,
          "detected": true,
          "detection_rate": 0.6666666666666666,
          "method": "2/3 runs detected"
        },
        {
          "p_intercept": 0.39999999999999997,
          "qber": 0.09314296558458579,
          "qber_std": 0.021995124673095084,
          "chsh_value": 1.8129207850117457,
          "chsh_std": 0.09266792012182967,
          "eve_info": 0.19999999999999998,
          "detected": true,
          "detection_rate": 1.0,
          "method": "3/3 runs detected"
        },
        {
          "p_intercept": 0.44999999999999996,
          "qber": 0.10582409239930325,
          "qber_std": 0.016778282269908868,
          "chsh_value": 1.6741345753256036,
          "chsh_std": 0.16097243713668022,
          "eve_info": 0.22499999999999998,
          "detected": true,
          "detection_rate": 1.0,
          "method": "3/3 runs detected"
        },
        {
          "p_intercept": 0.49999999999999994,
          "qber": 0.13790276573403937,
          "qber_std": 0.01677661742131658,
          "chsh_value": 1.4730244364791576,
          "chsh_std": 0.08728753632120562,
          "eve_info": 0.24999999999999997,
          "detected": true,
          "detection_rate": 1.0,
          "method": "3/3 runs detected"
        },
        {
          "p_intercept": 0.5499999999999999,
          "qber": 0.1108531131750946,
          "qber_std": 0.005126886329820738,
          "chsh_value": 1.3247212675159397,
          "chsh_std": 0.08248091516437138,
          "eve_info": 0.27499999999999997,
          "detected": true,
          "detection_rate": 1.0,
          "method": "3/3 runs detected"
        },
        {
          "p_intercept": 0.6,
          "qber": 0.15841585471924488,
          "qber_std": 0.008576175981456411,
          "chsh_value": 1.152880465760664,
          "chsh_std": 0.15018270251622742,
          "eve_info": 0.3,
          "detected": true,
          "detection_rate": 1.0,
          "method": "3/3 runs detected"
        }
      ],
      "threshold": 0.3
    }
  },
  "validation": {
    "checks": [
      {
        "name": "No attack = not detected",
        "passed": true,
        "detail": "Zero attack detected: False"
      },
      {
        "name": "Full attack = detected",
        "passed": true,
        "detail": "Full attack QBER: 26.6%"
      },
      {
        "name": "QBER increases with attack",
        "passed": true,
        "detail": "Increasing pairs: 8/8"
      },
      {
        "name": "CHSH decreases with attack",
        "passed": true,
        "detail": "Decreasing pairs: 8/8"
      },
      {
        "name": "Optimal cloner gives ~17% QBER",
        "passed": true,
        "detail": "QBER: 14.7% (expected: 16.7%)"
      }
    ],
    "all_passed": true
  },
  "summary": {
    "overall_passed": true,
    "detection_threshold": 0.3,
    "n_detected": 6,
    "n_total": 9
  }
}